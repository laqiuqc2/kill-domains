# 快速开始指南

## 开发环境设置（Mac）

### 1. 安装 Python 依赖

```bash
# 注意：在 Mac 上，pywin32 无法安装，这是正常的
# 只需要安装其他依赖即可
pip install requests pystray Pillow

# 或者使用 requirements.txt（会跳过 pywin32）
pip install -r requirements.txt || pip install requests pystray Pillow
```

### 2. 测试代码（仅测试逻辑，无法完整运行）

在 Mac 上无法完整运行程序（因为需要 Windows 和 win32 模块），但可以测试 API 获取等功能：

```python
# 可以单独测试 API 获取功能
python -c "import requests; r = requests.get('https://app.walkingcode.com/API/kill-domains.php'); print(r.json())"
```

## 编译 Windows EXE

### 推荐方法：GitHub Actions

1. **初始化 Git 仓库**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   ```

2. **推送到 GitHub**
   ```bash
   git remote add origin <your-repo-url>
   git push -u origin main
   ```

3. **等待自动编译**
   - GitHub Actions 会自动开始编译
   - 在仓库的 Actions 页面查看进度

4. **下载 exe**
   - 编译完成后，在 Actions 页面下载 artifact

### 备选方法：Windows 虚拟机

1. 在 Mac 上安装 Windows 虚拟机
2. 在虚拟机中安装 Python 3.11
3. 复制项目文件到虚拟机
4. 运行编译命令：
   ```bash
   pip install -r requirements.txt
   pip install pyinstaller
   pyinstaller build.spec
   ```

## 在 Windows 上使用

### 1. 运行程序

- **右键点击** `DomainKiller.exe`
- 选择 **"以管理员身份运行"**
- ⚠️ **必须使用管理员权限**，否则无法修改 hosts 文件

### 2. 使用系统托盘

程序运行后会在系统托盘（任务栏右下角）显示图标：

- **右键点击图标** 打开菜单
- **立即同步**: 立即从 API 获取最新域名并更新
- **恢复访问**: 移除所有屏蔽规则
- **退出**: 退出程序

### 3. 验证功能

1. **检查 hosts 文件**
   - 打开 `C:\Windows\System32\drivers\etc\hosts`
   - 应该能看到添加的屏蔽规则（标记在 `# === Kill Domains Start ===` 和 `# === Kill Domains End ===` 之间）

2. **测试屏蔽**
   - 尝试访问被屏蔽的域名
   - 应该无法访问或显示连接错误

3. **测试恢复**
   - 右键托盘图标，点击"恢复访问"
   - 检查 hosts 文件，屏蔽规则应该被移除

## 故障排除

### 问题：程序无法启动

- 检查是否以管理员身份运行
- 检查是否有杀毒软件阻止
- 查看是否有错误提示

### 问题：无法修改 hosts 文件

- 确保以管理员身份运行
- 检查 hosts 文件是否被其他程序锁定
- 尝试手动编辑 hosts 文件测试权限

### 问题：系统托盘图标不显示

- 检查系统托盘区域是否隐藏了图标
- 重启程序
- 检查 Windows 通知区域设置

### 问题：无法从 API 获取域名

- 检查网络连接
- 检查 API 地址是否可访问
- 查看程序日志（如果有控制台窗口）

## 开发调试

### 在 Windows 上直接运行 Python 代码

```bash
# 安装依赖
pip install -r requirements.txt

# 运行程序（需要管理员权限）
python kill_domains.py
```

### 查看日志

如果程序有控制台窗口，可以看到日志输出。如果没有，可以临时修改代码添加日志文件。

## 下一步

- 查看 [README.md](README.md) 了解完整功能
- 查看 [编译指南.md](编译指南.md) 了解详细编译方法
- 查看 [api说明.md](api说明.md) 了解 API 格式

